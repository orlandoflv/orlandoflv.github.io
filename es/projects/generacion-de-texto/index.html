<!doctype html><html lang=es dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="es"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="rgb(255,255,255)"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Proyecto de generaci√≥n de texto en espa√±ol &#183; orlandoflv.github.io</title><meta name=title content="Proyecto de generaci√≥n de texto en espa√±ol &#183; orlandoflv.github.io"><meta name=description content="Sobre la trayectoria seguida para lograr generar texto en espa√±ol."><link rel=canonical href=https://orlandoflv.github.io/es/projects/generacion-de-texto/><link type=text/css rel=stylesheet href=/css/main.bundle.min.98b53c8c9a032010e70d072e787748198d2ffc88921908634d9baa581c809e50eaff7831558bf89858451f718699f62dcbfb38b45157f8d0bc0f4afb699cc7ec.css integrity="sha512-mLU8jJoDIBDnDQcueHdIGY0v/IiSGQhjTZuqWByAnlDq/3gxVYv4mFhFH3GGmfYty/s4tFFX+NC8D0r7aZzH7A=="><script type=text/javascript src=/js/appearance.min.c6198a5ecbc6c7b35a8568d29315f50cf5d775d4461c515a476359767f1a745c245aa83fa96b0c7d83da976cf77481e1fc29537a2391a53ffe69a991638802e6.js integrity="sha512-xhmKXsvGx7NahWjSkxX1DPXXddRGHFFaR2NZdn8adFwkWqg/qWsMfYPal2z3dIHh/ClTeiORpT/+aamRY4gC5g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.6d78c827ca7bcbf72056dbf698bf9aeb759a08966686187deb23f5949f73eca5f39b461284900cdfc08e2976d99eb80a8663648de778ba2a83e633ae16dbfc25.js integrity="sha512-bXjIJ8p7y/cgVtv2mL+a63WaCJZmhhh96yP1lJ9z7KXzm0YShJAM38COKXbZnrgKhmNkjed4uiqD5jOuFtv8JQ==" data-copy=Copiar data-copied=Copiado></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="Proyecto de generaci√≥n de texto en espa√±ol"><meta property="og:description" content="Sobre la trayectoria seguida para lograr generar texto en espa√±ol."><meta property="og:type" content="article"><meta property="og:url" content="https://orlandoflv.github.io/es/projects/generacion-de-texto/"><meta property="article:section" content="projects"><meta property="article:published_time" content="2022-08-28T23:10:24-05:00"><meta property="article:modified_time" content="2022-08-28T23:10:24-05:00"><meta property="og:site_name" content="orlandoflv.github.io"><meta name=twitter:card content="summary"><meta name=twitter:title content="Proyecto de generaci√≥n de texto en espa√±ol"><meta name=twitter:description content="Sobre la trayectoria seguida para lograr generar texto en espa√±ol."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"","name":"Proyecto de generaci√≥n de texto en espa√±ol","headline":"Proyecto de generaci√≥n de texto en espa√±ol","abstract":"Sobre la trayectoria seguida para lograr generar texto en espa√±ol.","inLanguage":"es","url":"https:\/\/orlandoflv.github.io\/es\/projects\/generacion-de-texto\/","author":{"@type":"Person","name":""},"copyrightYear":"2022","dateCreated":"2022-08-28T23:10:24-05:00","datePublished":"2022-08-28T23:10:24-05:00","dateModified":"2022-08-28T23:10:24-05:00","keywords":["Machine learning","RNN","LSTM","Transformers","BLOOM"],"mainEntityOfPage":"true","wordCount":"1057"}]</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JENVCDEBJL"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JENVCDEBJL",{anonymize_ip:!1})}</script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Ir al contenido</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral print:hidden sm:py-10"><nav class="flex items-start justify-between sm:items-center"><div class="z-40 flex flex-row items-center"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/es/>orlandoflv.github.io</a><ul class="flex flex-row list-none"><li class=ml-2><a href=/projects/text-generation/ class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2">üá¨üáß</a></li><li class=ml-2><a href=/es/projects/generacion-de-texto/ class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2">üá™üá∏</a></li></ul></div><label id=menu-button for=menu-controller class="block sm:hidden"><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-full h-full m-auto overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex flex-col w-full px-6 py-6 mx-auto overflow-visible list-none max-w-7xl ltr:text-right rtl:text-left sm:px-14 sm:py-10 sm:pt-10 md:px-24 lg:px-32"><li class=mb-1><span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class="mb-1 group"><a href=/es/projects/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Proyectos</span></a></li><li class="mb-1 group"><a href=/es/tags/ title=Tags><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="mb-1 group"><button id=search-button-1 title="Buscar (/)">
<span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li><li class="mb-1 group"><button id=appearance-switcher-1 type=button aria-label="appearance switcher">
<span class="inline transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600 dark:hidden" title="Cambiar a modo oscuro"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></span>
<span class="hidden transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600 dark:inline" title="Cambiar a modo claro"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></span></button></li></ul></div></label><ul class="flex-row hidden list-none ltr:text-right rtl:text-left sm:flex"><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/es/projects/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Proyectos</span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a href=/es/tags/ title=Tags><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><button id=search-button-2 title="Buscar (/)">
<span class="transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li><li class="mb-1 group sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><button id=appearance-switcher-2 type=button aria-label="appearance switcher">
<span class="inline transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600 dark:hidden" title="Cambiar a modo oscuro"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></span>
<span class="hidden transition-colors group-dark:hover:text-primary-400 group-hover:text-primary-600 dark:inline" title="Cambiar a modo claro"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></span></button></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/es/>Orlando F. V√°zquez</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/es/projects/>projects</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/es/projects/generacion-de-texto/>Proyecto de generaci√≥n de texto en espa√±ol</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Proyecto de generaci√≥n de texto en espa√±ol</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-08-28 23:10:24 -0500 -0500">28 agosto 2022</time><span class="px-2 text-primary-500">&#183;</span><span title="Tiempo de lectura">5 mins</span><span class="px-2 text-primary-500">&#183;</span>
<span class=mb-[2px]><a href=https://github.com/orlandoflv/orlandoflv.github.io/tree/main/content/projects/generacion-de-texto.es.md class="text-lg hover:text-primary-500" rel="noopener noreferrer" target=_blank title="Editar contenido"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M490.3 40.4c21.9 21.87 21.9 57.33.0 79.2l-30 30.1-98-97.98 30.1-30.06C414.3-.2135 449.7-.2135 471.6 21.66L490.3 40.4zM172.4 241.7 339.7 74.34l98 97.96L270.3 339.6C264.2 345.8 256.7 350.4 248.4 353.2l-88.8 29.6C150.1 385.6 141.5 383.4 135 376.1 128.6 370.5 126.4 361 129.2 352.4l29.6-88.8C161.6 255.3 166.2 247.8 172.4 241.7v0zM192 63.1c17.7.0 32 15.23 32 32 0 18.6-14.3 32-32 32H96c-17.67.0-32 15.2-32 32V416c0 17.7 14.33 32 32 32H352c17.7.0 32-14.3 32-32V319.1c0-16.8 14.3-32 32-32s32 15.2 32 32V416c0 53-43 96-96 96H96c-53.02.0-96-43-96-96V159.1c0-53 42.98-96 96-96h96z"/></svg></span></a></span></div><div class="my-1 text-xs leading-relaxed text-neutral-500 dark:text-neutral-400"><a href=/es/tags/machine-learning/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Machine learning</a>
<a href=/es/tags/rnn/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">RNN</a>
<a href=/es/tags/lstm/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">LSTM</a>
<a href=/es/tags/transformers/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">Transformers</a>
<a href=/es/tags/bloom/ class="rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400">BLOOM</a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Tabla de contenido</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#generaci√≥n-de-texto-en-espa√±ol>Generaci√≥n de texto en espa√±ol</a></li><li><a href=#planteando-el-proyecto>Planteando el proyecto</a></li><li><a href=#primeros-resultados-y-cambio-de-enfoque>Primeros resultados y cambio de enfoque</a></li><li><a href=#utilizando-transformers-y-gpt-2>Utilizando <em>transformers</em> y GPT-2</a></li><li><a href=#modelos-para-generar-texto-en-espa√±ol>Modelos para generar texto en espa√±ol</a></li><li><a href=#web-scraping>Web scraping</a></li><li><a href=#entrenamiento-del-modelo-y-conclusiones>Entrenamiento del modelo y conclusiones</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose grow"><div class="lead !mb-9 text-xl">Sobre la trayectoria seguida para lograr generar texto en espa√±ol</div><h2 id=generaci√≥n-de-texto-en-espa√±ol class="relative group">Generaci√≥n de texto en espa√±ol <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#generaci%c3%b3n-de-texto-en-espa%c3%b1ol aria-label=Ancla>#</a></span></h2><p>Quiero empezar este texto mostrando inmediatamente el resultado del primer proyecto que realic√© en <em>machine learning</em>: un generador de texto en espa√±ol a partir de hacer <em>fine-tuning</em> a un modelo existente (<em>BLOOM</em>) usando <em>Transformers</em>. El entrenamiento se realiz√≥ a partir de las transcripciones de las conferencias de prensa y discursos p√∫blicos del presidente de M√©xico, Andr√©s Manuel L√≥pez Obrador, por lo que el texto generado se caracteriza por replicar su particular manera de comunicarse de forma verbal.</p><p><gradio-app src=https://neek05-nlp-amlo.hf.space></gradio-app></p><p>A partir de aqu√≠ el relato de la trayectoria para llegar a este resultado, <strong>aclarando que el texto no pretende ser un tutorial ni explicar los detalles espec√≠ficos para la creaci√≥n de esta app.</strong></p><h2 id=planteando-el-proyecto class="relative group">Planteando el proyecto <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#planteando-el-proyecto aria-label=Ancla>#</a></span></h2><p>En mi trayectoria por aprender <em>recurrent neural networks</em> (RNN) decid√≠ que uno de los primeros proyectos que trabajar√≠a de forma personal fuese uno de generaci√≥n de texto a nivel de caracteres, lo cual me ayudar√≠a a comprender mejor su funcionamiento y a poner en pr√°ctica lo aprendido. Decid√≠ iniciar el proyecto trabajando a partir textos de Donald Trump, al considerar que habr√≠a mucho material disponible, si bien pronto se volvi√≥ evidente que no era <a href=https://github.com/ZaydH/trump_char_rnn target=_blank rel="noreferrer noopener">precisamente</a> <a href=https://www.csail.mit.edu/news/postdoc-develops-twitterbot-uses-ai-sound-donald-trump target=_blank rel="noreferrer noopener">la idea</a> <a href=https://towardsdatascience.com/predicting-trump-tweets-with-a-rnn-95e7c398b18e target=_blank rel="noreferrer noopener">m√°s</a> <a href=https://github.com/ppramesi/RoboTrumpDNN target=_blank rel="noreferrer noopener">novedosa</a>.</p><p>Para darle un poco m√°s de originalidad y diversidad al asunto, eleg√≠ trabajar no a partir de textos escritos por el expresidente en libros o <em>tweets</em>, sino a partir de las transcripciones de sus discursos p√∫blicos, por lo que podr√≠amos ver este ejercicio como un generador de discursos.</p><h2 id=primeros-resultados-y-cambio-de-enfoque class="relative group">Primeros resultados y cambio de enfoque <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#primeros-resultados-y-cambio-de-enfoque aria-label=Ancla>#</a></span></h2><p>Utilizando una red neuronal LSTM (<em>Long Short Term Memory</em>) en <em>PyTorch</em> y con un entrenamiento de 30 <em>epochs</em> los primeros resultados obtenidos fueron&mldr; curiosos:</p><blockquote><p>The media is going to be talking about the farmers. They‚Äôre a very good job and we are trying to be a great job that they have to be and with the problem. I think it‚Äôs not allowed to get it, they don‚Äôt want to say it. They want to give them all the time. I think it will start to get along with a land. We had a great service and the first time to say the sand and energy independence, but when the suburbs, they‚Äôve been able to do that&mldr;</p></blockquote><p>Como ejercicio result√≥ francamente entretenido y el resultado divertido de leer. El texto generado, si bien se puede apreciar el estilo de expresarse del expresidente estadounidense, carece de coherencia. Sin embargo en un modelo entrenado desde cero, con un hardware limitado, era esperable que los resultados no fueran espectaculares en el primer intento. Habiendo le√≠do ya un poco de literatura de sobre <em>transfer learning</em> me pareci√≥ que este podr√≠a ser un excelente ejercicio para ponerlo en la pr√°ctica y ver los beneficios que podr√≠a obtener utilizando modelos previamente entrenados.</p><h2 id=utilizando-transformers-y-gpt-2 class="relative group">Utilizando <em>transformers</em> y GPT-2 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#utilizando-transformers-y-gpt-2 aria-label=Ancla>#</a></span></h2><p>El siguiente paso en este proyecto fue documentarme sobre el funcionamiento de la librer√≠a <em>Transformers</em> de <a href=https://huggingface.co/ target=_blank rel="noreferrer noopener"><em>Hugging Face</em></a> y tratar de mejorar los resultados previamente obtenidos. El modelo utilizado en esta ocasi√≥n fue GPT-2, modelo de generaci√≥n de texto puesto a disposici√≥n por <em>OpenAI</em> en 2019. Despu√©s de mucha prueba y error y tras ir ajustando diversos par√°metros en el modelo, logre generar los siguientes textos:</p><p><figure><img class="mx-auto my-0 rounded-md" src=../ResultadosGPT-2.png alt="Generaci√≥n de texto con GPT-2"></figure></p><p>Se observan resultados de mucha mayor calidad que en el primer ejercicio y en una cantidad de tiempo relativamente breve, lo cual indicaba que este era un buen camino por seguir.</p><h2 id=modelos-para-generar-texto-en-espa√±ol class="relative group">Modelos para generar texto en espa√±ol <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#modelos-para-generar-texto-en-espa%c3%b1ol aria-label=Ancla>#</a></span></h2><p>Sin embargo, lo que realmente deseaba realizar desde un primer momento era la generaci√≥n de texto en espa√±ol, tratando de replicar la calidad de los resultados obtenidos entrenando el modelo en ingl√©s. De ah√≠ que consider√© que una vez obtenidos resultados aceptables en la generaci√≥n de texto en ingl√©s, ser√≠a sencillo replicar los resultados con texto en espa√±ol. Desafortunadamente, esto no fue as√≠ y ya ciertos <a href=https://www.vanderbilt.edu/digitalhumanities/gpt-2-no-habla-espanol-artificial-intelligence-anglocentrism-and-the-non-human-side-of-dh/ target=_blank rel="noreferrer noopener">art√≠culos</a> mencionan las limitaciones del modelo GPT-2 para la generaci√≥n de texto en idiomas distintos al ingl√©s.</p><p>Si bien se encuentran disponibles en <a href=https://huggingface.co/models target=_blank rel="noreferrer noopener"><em>Hugging Face</em></a> modelos de GPT-2 entrenados con un corpus en espa√±ol, tras haber leido recientemente sobre esta iniciativa, decid√≠ que ser√≠a un buen ejercicio probar el modelo multilenguaje de <a href=https://huggingface.co/bigscience/bloom target=_blank rel="noreferrer noopener"><em>BLOOM</em></a>, proyecto de ciencia abierta y de acceso libre entrenado para generar texto en 46 idiomas y que fue hecho p√∫blico en julio de este mismo a√±o.</p><h2 id=web-scraping class="relative group">Web scraping <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#web-scraping aria-label=Ancla>#</a></span></h2><p>En esta ocasi√≥n decid√≠ que la generaci√≥n de texto en espa√±ol ser√≠a a partir de transcripciones conferencias y discursos del presidente Andr√©s Manuel L√≥pez Obrador, y el motivo por el cual seleccionar a este personaje fue similar al anterior: amplia disponibilidad de material en internet. El proceso para obtener las transcripciones parti√≥ de hacer <em>web scraping</em> desde la p√°gina del <a href=https://lopezobrador.org.mx/transcripciones/ target=_blank rel="noreferrer noopener">presidente</a> donde se encuentran disponibles estas transcripciones.</p><p>Utilizando <a href=https://scrapy.org/ target=_blank rel="noreferrer noopener">Scrapy</a> obtuve 1609 transcripciones de conferencias de prensa y discursos en eventos p√∫blicos del 4 de diciembre de 2018 al 21 de julio de 2022. Una vez realizada la limpieza de las transcripciones y manteniendo √∫nicamente las participaciones del presidente L√≥pez Obrador y eliminando las participaciones de cualquier otro personaje, esto se tradujo en 38 MB de discursos y conferencias transcritas, equivalente a 36,795,294 caracteres.</p><h2 id=entrenamiento-del-modelo-y-conclusiones class="relative group">Entrenamiento del modelo y conclusiones <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#entrenamiento-del-modelo-y-conclusiones aria-label=Ancla>#</a></span></h2><p>Para poder entrenar el modelo y debido a las limitaciones de hardware tuve que hacer varios ajustes: en primer lugar utilizar el modelo de BLOOM m√°s peque√±o disponible (que aun as√≠ cuenta con 560 millones de par√°metros), mantener √∫nicamente el 25% del texto obtenido, que a su vez, para evitar problemas con la RAM, tuve que dividir en oraciones completas con un m√°ximo de 1000 caracteres.</p><p>Otra limitaci√≥n adicional, fue que al momento de programar la aplicaci√≥n utilizando <em>Gradio</em> y al subirla a <a href=https://huggingface.co/spaces target=_blank rel="noreferrer noopener"><em>Hugging Spaces</em></a>, por cuesti√≥n del tiempo requerido para generar el texto, vi necesario limitar la generaci√≥n a solo 100 palabras.</p><p>El resultado del <em>fine tuning</em> tras un entrenamiento de 5 <em>epochs</em>, es la generaci√≥n de un texto decente, como se puede ver al inicio, que a diferencia de los primeros ejercicios, mantiene al menos una coherencia y estructura dentro de las oraciones generadas. Considero que a√∫n hay margen de mejora y afortunadamente la <em>API</em> de <em>transformers</em> tiene la suficiente flexibilidad para ir ajustando distintos par√°metros tanto en el entrenamiento como en la generaci√≥n de texto. Espero subir pr√≥ximamente un tutorial detallado sobre los pasos seguidos en este proyecto.</p><script type=module src=https://gradio.s3-us-west-2.amazonaws.com/3.27/gradio.js></script></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=flex><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span></span><span><a class="group flex text-right" href=/es/projects/prediccion-covid19/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Prediciendo la probabilidad de muerte por COVID-19 en M√©xico durante 2020</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2022-09-24 13:00:16 -0500 -0500">24 septiembre 2022</time></span></span>
<span class="ml-2 text-neutral-700 transition-transform group-hover:translate-x-[2px] group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Ir arriba" title="Ir arriba">&uarr;</a></div></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2023</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Desarrollada con <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a></p></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://orlandoflv.github.io/es/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Buscar tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Cerrar (Esc)">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>